rules:
  - id: file-put-contents
    languages:
      - php
    severity: ERROR
    message: Possible file write sink file_put_contents
    patterns:
      - pattern: file_put_contents($FILE, ...)
      - metavariable-regex:
          metavariable: $FILE
          regex: ".*log.*"
  
  - id: file-put-contents_log-file-var-assignment
    languages:
      - php
    severity: ERROR
    message: Variable passed to file_put_contents contains 'log'
    patterns:
      - pattern: |-
          $FILE = $EXPR;
          ...
          file_put_contents($FILE, ...);
      - metavariable-pattern:
          metavariable: $EXPR
          pattern-regex: .*log.*


  - id: fopen_var-assignment
    languages:
      - php
    severity: ERROR
    message: Variable passed to file_put_contents contains 'log'
    patterns:
      - pattern: |-
          $FILE = $EXPR;
          ...
          fopen($FILE, ...);
      - metavariable-pattern:
          metavariable: $EXPR
          pattern-regex: .*log.*

  - id: fwrite_with-fopen
    languages:
      - php
    severity: ERROR
    message: Variable passed to file_put_contents contains 'log'
    patterns:
      - pattern: |-
          $FILE = $EXPR;
          ...
          fwrite($FILE, ...);
      - metavariable-pattern:
          metavariable: $EXPR
          pattern-regex: fopen(.*log.*)

  - id: fprintf_with-fopen
    languages:
      - php
    severity: ERROR
    message: Variable passed to file_put_contents contains 'log'
    patterns:
      - pattern: |-
          $FILE = $EXPR;
          ...
          fprintf($FILE, ...);
      - metavariable-pattern:
          metavariable: $EXPR
          pattern-regex: fopen(.*log.*)

  - id: fputs_with-fopen
    languages:
      - php
    severity: ERROR
    message: Variable passed to file_put_contents contains 'log'
    patterns:
      - pattern: |-
          $FILE = $EXPR;
          ...
          fputs($FILE, ...);
      - metavariable-pattern:
          metavariable: $EXPR
          pattern-regex: fopen(.*log.*)

  - id: wp-upload-dir_
    languages: [php]
    message: Use of wp_upload_dir (may indicate log or file path handling)
    severity: INFO
    patterns:
      - pattern: wp_upload_dir(...)

  - id: hardcoded-wp-content-path
    languages: [php]
    message: Hardcoded path under /wp-content/ detected
    severity: INFO
    patterns:
      - pattern-regex: ".*/wp-content/.*"
  
  - id: WP-DEBUG_enabling
    languages: [php]
    message: Plugin enabled WP_DEBUG is assumed to be FALSE in wp-config.php
    severity: WARNING
    patterns:
      - pattern: define( 'WP_DEBUG', true );
  
  - id: WP-DEBUG-LOG_enabling
    languages: [php]
    message: Plugin enabled WP_DEBUG_LOG is assumed to be FALSE in wp-config.php
    severity: WARNING
    patterns:
      - pattern: define( 'WP_DEBUG_LOG', true );

